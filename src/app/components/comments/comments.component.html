<div class="chat-container" #chatContainer>
  <div
    *ngFor="let comment of comments"
    class="message-wrapper"
    [class.from-client]="isClientMessage(comment)"
    [class.from-user]="!isClientMessage(comment)"
  >
    <div class="message-bubble">
      <i
        [pTooltip]="
          isUnread(comment)
            ? 'Oznacz jako przeczytane'
            : 'Oznacz jako nieprzeczytane'
        "
        tooltipPosition="top"
        class="pi pi-comment comment-icon"
        [ngClass]="
          isUnread(comment) ? 'comment-icon-unread' : 'comment-icon-read'
        "
        (click)="toggleCommentRead(comment.id)"
      ></i>

      <i
        class="pi pi-pencil edit-icon"
        (click)="markCommentToEdit(comment.id)"
        pTooltip="Edytuj"
        tooltipPosition="top"
      ></i>
      <i
        pTooltip="Usuń"
        tooltipPosition="top"
        class="pi pi-trash delete-icon"
        (click)="deleteComment(comment.id)"
      ></i>
      <p class="text">{{ comment.comment }}</p>
      <span class="timestamp">
        {{ comment.authorName }}, {{ comment.createdAt }}
      </span>
    </div>
  </div>
</div>

<div class="new-message-input-wrapper">
  <div class="all-comments">
    <div
      class="comment-read flex-center cursor-pointer"
      pTooltip="Oznacz wszystkie jako przeczytane"
      tooltipPosition="top"
      (click)="markAllComments(true, isUser ? 'client' : 'user')"
    >
      <i class="pi pi-comments"></i>
    </div>
    <div
      class="comment-unread flex-center cursor-pointer"
      pTooltip="Oznacz wszystkie jako nieprzeczytane"
      tooltipPosition="top"
      (click)="markAllComments(false, isUser ? 'client' : 'user')"
    >
      <i class="pi pi-comments"></i>
    </div>
  </div>
  <input
    type="text"
    [(ngModel)]="newMessage"
    class="new-message-input"
    placeholder="Napisz wiadomość..."
    (keyup.enter)="sendComment()"
    name="new-message"
  />
  <div class="send-btn-wrapper flex-center">
    <button
      class="send-btn"
      (click)="sendComment()"
      [ngClass]="{ disabled: !newMessage }"
    >
      <i class="pi pi-arrow-up send-icon"></i>
    </button>
  </div>
</div>
