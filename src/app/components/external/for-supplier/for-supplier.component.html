<div class="supplier-container" *ngIf="!isLoading">
  <div class="container">
    <div class="header">
      <div class="header-cell-client">
        <p class="header-title">Dane klienta</p>
        <p><strong>Inwestycja: </strong>{{ setName }}</p>
        <p>
          <strong>Imię i nazwisko: </strong
          >{{ client.firstName + " " + client.lastName }}
        </p>
        <p><strong>Firma: </strong>{{ client.company }}</p>
      </div>
      <div>
        <p class="header-title">Dostawca</p>
        <p><strong>Firma: </strong>{{ supplier.company }}</p>
      </div>
      <div class="header-cell-logo">
        <a href="https://zurawickidesign.pl" target="_blank">
          <img
            src="/assets/images/logo-black.png"
            alt="Żurawicki Design logo"
            width="400px"
          />
        </a>
      </div>
    </div>

    <app-loading-spinner
      class="image-spinner"
      [size]="200"
      *ngIf="isLoading"
    ></app-loading-spinner>

    <p-table
      stripedRows
      dataKey="id"
      columnResizeMode="expand"
      class="p-datatable-gridlines"
      [resizableColumns]="false"
      [scrollable]="true"
      [value]="positions"
      [reorderableColumns]="true"
      [tableStyle]="{ 'min-width': '100rem', 'table-layout': 'fixed' }"
    >
      <!-- table header  -->
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem" class="position-header text-center">LP</th>
          <th
            *ngFor="let column of columnListForSupplierWithWidth"
            class="position-header"
            [ngClass]="column.classHeader"
            pResizableColumn
            [ngStyle]="{ width: column?.width + 'px' }"
          >
            {{ column.name }}
          </th>
        </tr>
      </ng-template>
      <!-- table body  -->
      <ng-template
        pTemplate="body"
        let-position
        let-editing="editing"
        let-i="rowIndex"
      >
        <tr>
          <td class="lp">
            <span title="{{ position.id }}">{{ i + 1 }}</span>
          </td>
          <!-- main content -->
          <td
            *ngFor="let column of columnListForSupplierWithWidth"
            [ngClass]="column.classColumn"
            [ngStyle]="{ width: column?.width + 'px' }"
          >
            <p-cellEditor>
              <ng-template pTemplate="output">
                <span class="view-mode" [ngSwitch]="column.type">
                  <!-- type = number  -->
                  <div *ngSwitchCase="'number'">
                    {{ position[column.key] | number: "1.2-2" }}
                  </div>
                  <div *ngSwitchCase="'select'">
                    {{
                      column.optionLabel
                        ? position[column.key]?.[column.optionLabel]
                        : position[column.key]
                    }}
                  </div>
                  <!-- type = image  -->
                  <div *ngSwitchCase="'image'">
                    <img
                      *ngIf="position['imageUrl']"
                      [src]="position['imageUrl']"
                      class="view-mode-image"
                      alt="image"
                    />
                  </div>
                  <!-- type = string  -->
                  <div *ngSwitchCase="'string'">
                    {{ position[column.key] }}
                  </div>
                  <!-- type = link  -->
                  <div *ngSwitchCase="'link'">
                    <a
                      [href]="position[column.key]"
                      *ngIf="position[column.key]"
                      target="_blank"
                      class="link flex-center"
                      rel="noopener noreferrer"
                    >
                      <i class="pi pi-link"></i>LINK
                    </a>
                  </div>
                  <!-- type = textarea  -->
                  <!-- prettier-ignore -->
                  <div *ngSwitchCase="'textarea'" style="white-space: pre-wrap">{{ position[column.key] }}</div>
                </span>
              </ng-template>
            </p-cellEditor>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
