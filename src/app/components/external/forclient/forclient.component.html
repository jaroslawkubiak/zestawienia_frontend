<app-send-files who="client" />
<app-show-files who="client" />

<div class="container" *ngIf="set">
  <div class="header-background">
    <div class="header">
      <div>
        <h3>Witamy w zestawieniu do inwestycji</h3>
        <h1>{{ set.name }}</h1>
      </div>
      <div class="header-actions-btn">
        <div class="action-btn-wrapper" (click)="showAttachedFiles()">
          <i class="pi pi-cloud"></i>
          <p-badge
            [value]="filesCount"
            [severity]="filesSeverity"
            class="nr-files"
            badgeSize="large"
            [pTooltip]="'Ilość załączonych plików'"
          ></p-badge>
          <label> Załączone pliki </label>
        </div>
        <div
          class="action-btn-wrapper"
          (click)="openSendFilesDialog(set.id, set.hash, set.name)"
        >
          <i id="upload-icon" class="pi pi-paperclip"></i>
          <label for="upload-icon"> Wgraj swój plik </label>
        </div>
      </div>
    </div>
  </div>
  <div class="set-content">
    <p-tabs [value]="selectedBookmark" scrollable>
      <p-tablist>
        @for (bookmark of set.bookmarks; track bookmark.id) {
        <p-tab
          [value]="bookmark.id"
          (click)="loadContentForBookmark(bookmark.id)"
          >{{ bookmark.name }}</p-tab
        >
        }
      </p-tablist>
      <p-tabpanels>
        @for (bookmark of set.bookmarks; track bookmark.id) {
        <p-tabpanel [value]="bookmark.id">
          <!-- bookmark = summary -->
          @if(selectedBookmark === 1) {
          <app-summary [set]="set" [positions]="positions"></app-summary>
          } @else {
          <!-- other bookmarks -->
          <ng-container *ngIf="selectedBookmark === bookmark.id">
            <li *ngFor="let pos of positionsFromBookmark; let i = index">
              <app-product
                class="positions-item"
                [position]="pos"
                [index]="i + 1"
                [positionsWithBadge]="positionsWithBadge"
                [comments]="comments"
                [set]="set"
                [countNewComments]="countNewComments"
              />
            </li>
          </ng-container>
          }
        </p-tabpanel>
        }
      </p-tabpanels>
    </p-tabs>
    <app-legend></app-legend>
  </div>
</div>
